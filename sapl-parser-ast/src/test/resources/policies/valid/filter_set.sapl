/*
 * This policy set uses the 'deny-wins or permit' combining algorithm.
 * This means that access is permitted unless a policy in the set
 * explicitly denied access.
 */
set "filter_set"
deny-wins or permit

/*
 * This policy black-lists GET requests to the requestURI '/secret' for all
 * unauthenticated users. 
 */
policy "deny_secret"
deny
where
    action.method == "GET";
    "ROLE_ANONYMOUS" in subject..authority;
    resource.requestedURI == "/secret";
